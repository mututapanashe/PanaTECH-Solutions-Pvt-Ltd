(self.modernJsonp=self.modernJsonp||[]).push([["40370"],{361667(e,t,o){o.r(t),o.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupCommentButton_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"commentsDisabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null}],type:"Pin",abstractKey:null};n.hash="86b6e3c1bac7a349ee111a45e01f624e";let l=n},891819(e,t,o){o.r(t),o.d(t,{default:()=>h});var n,l=o(61163),i=o(859471);o(224989);var s=o(19821),a=o(548253),r=o(586733),c=o(535273),d=o(538329),u=o(678358),m=o(808571),p=o(562615);let g=(void 0!==n||(n=o(361667)).hash&&"86b6e3c1bac7a349ee111a45e01f624e"!==n.hash&&console.error("The definition of 'CloseupCommentButton_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function h({isEligibleForAggregatedComments:e,pinKey:t,totalCommentCount:o,viewParameter:n,viewType:h,scrollContainerRef:f}){(0,i.useEffect)(()=>{(0,l.A)("CloseupCommentButton","/app/common/react/components/auth-desktop-web-closeup/CloseupActionBar/CloseupCommentButton.tsx")},[]);let v=(0,d.A)(),C=(0,m.g)(),b=(0,c.A)(g,t),w=(0,a.A)({showProductDetailPage:!!b.isEligibleForPdp}),{isCommentThreadExpanded:_,setIsCommentThreadExpanded:B,setIsCommentComposerFocused:E}=(0,u._G)(),{logContextEvent:y}=(0,r.o)(),[T,I]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(!w||!f)return;let e=document.getElementById("canonical-card");if(!e)return;let t=new IntersectionObserver(e=>{let t=e[0];t&&I(t.isIntersecting)},{root:f,threshold:0});return t.observe(e),setTimeout(()=>{let o=t.takeRecords();if(o.length>0&&o[0])I(o[0].isIntersecting);else{let t=f.getBoundingClientRect(),o=e.getBoundingClientRect();I(o.top>=t.top&&o.top<=t.bottom)}},100),()=>{t.disconnect()}},[w,f]);let x=v._('Comments', 'Closeup.Comment.Icon', 'Icon for scrolling comments into view'),A=()=>{let e=document.getElementById("canonical-card"),t=document.querySelector('[data-test-id="canonical-card-tap-area"]');if(!e)return;if(w&&f){let o=f.getBoundingClientRect(),n=e.getBoundingClientRect().top-o.top,l=f.scrollTop+n-C,i=null,s=()=>{i&&clearTimeout(i),i=setTimeout(()=>{B?.(!0),t&&t.focus(),f.removeEventListener("scroll",s)},100)};f.addEventListener("scroll",s,{passive:!0}),s(),f.scrollTo({top:l,behavior:"smooth"});return}let o=e.getBoundingClientRect().top+window.scrollY-C,n=null,l=()=>{n&&clearTimeout(n),n=setTimeout(()=>{t&&t.focus(),window.removeEventListener("scroll",l)},100)};window.addEventListener("scroll",l,{passive:!0}),l(),window.scrollTo({top:o,behavior:"smooth"})};return(0,p.jsx)(s.az,{role:"listitem",children:(0,p.jsx)(s.so,{alignItems:"center",direction:"row",children:(0,p.jsx)(s.K0,{accessibilityLabel:x,disabled:!e||!!b.commentsDisabled,icon:"speech",onClick:()=>{if(w){if(!T)return void A();_||!(o>0)||B?.(!0),y({component:13464,element:2,event_type:10554,view_parameter:n,view_type:h}),E(!0)}else A()},size:"lg",tooltip:{text:x}})})})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/CloseupCommentButton-1c26100abf3f3caa.mjs.map